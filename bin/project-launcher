#!/bin/bash

projects_file=${XDG_DATA_HOME:-${HOME}/.local/share}/projects

declare -A projects

while read -r line; do
  projects[${line##*/}]=${line}
done < "${projects_file}"

project=$(printf "%s\n" "${!projects[@]}" | rofi -dmenu -i)

if [[ -z ${project} ]]; then
  exit 1
fi

p=${projects[${project}]}

if [[ $1 == "vscode" ]]; then
  code "${p}"
elif [[ $1 == "zed" ]]; then
  zeditor "${p}"
elif [[ $1 == "nvim" ]]; then
  if command -v neovide &> /dev/null; then
    neovide -- --cmd "cd ${p}"
  else
    kitty nvim --cmd "cd ${p}"
  fi
else
  echo "No editor specified."
  notify-send "No editor specified."
  exit 1
fi
